---
title: "R Interlude - ML estimation in R"
output:
  pdf_document: default
  html_notebook: default
  html_document: default
---

### Setting up a range of probability values between 0 and 1 for the binomial sampling equation


```{r}
p <- seq(0, 1.0, by=0.001)
length(p)
```

### Calculating the log likelihood for each value in the range of probabilities

```{r}
lnL <- dbinom(359, 1000, p, log=TRUE)
length(lnL)
```

### Plotting the log likelihood function

```{r}
plot(p, lnL, type = 'l')
```

### Creating a dataframe of all of the values

```{r}
lnL_func <- data.frame(p, lnL)
```


### Now, subset the dataframe to get the row for which lnL is at its max

```{r}
subset(lnL_func, lnL==max(lnL))
```



### MLE is 0.359

### Now, subset the datframe to get all rows for which lnL is at least as large as ML-1.92

```{r}
ci_interval <- subset(lnL_func, lnL>=max(lnL)-1.92)
```


### Approximate CI min and max as follows

```{r}
min(ci_interval$p)
max(ci_interval$p)
```
